---
import Layout from "../../layouts/Layout.astro";
export async function getStaticPaths() {
  function getDir(str: string) {
    return str.replace(/^\.\/(.*)\/.*\.md$/, "$1");
  }
  const categories = Object.keys(import.meta.glob("./**/*.md")).map(getDir);
  console.log(categories);
  const notes = await Astro.glob(`./**/*.md`);

  return categories.map((category) => {
    return {
      params: {
        slug: category,
      },
      props: {
        notes: notes.filter((note) => note.url!.includes(category)),
        title: category
          .split("-")
          .map((word) => word[0].toUpperCase() + word.slice(1))
          .join(" "),
      },
    };
  });
}
const { notes, title } = Astro.props;
console.log(notes[0].url);
---

<Layout title={title}>
  <h1>test</h1>
  <ul>
    {
      notes.map((note: any) => (
        <li>
          <a href={note.url}>{note.frontmatter.title}</a>
        </li>
      ))
    }
  </ul>
</Layout>
